(()=>{var e={};e.id=8489,e.ids=[8489],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32383:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>p,serverHooks:()=>f,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{POST:()=>c});var a=r(96559),i=r(48088),n=r(37719),o=r(32190),u=r(91054);async function c(e){try{let t=e.cookies.get("auth-token")?.value;if(t)try{await (0,u.dF)(t)}catch{}let r=o.NextResponse.json({message:"Logout successful"},{status:200});return r.cookies.set("auth-token","",{httpOnly:!0,secure:!0,sameSite:"strict",maxAge:0}),r}catch(e){return console.error("Logout error:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/logout/route",pathname:"/api/auth/logout",filename:"route",bundlePath:"app/api/auth/logout/route"},resolvedPagePath:"/Users/harsh/Downloads/punjabi-ecom-storeV4/app/api/auth/logout/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:f}=p;function w(){return(0,n.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},91054:(e,t,r)=>{"use strict";r.d(t,{BE:()=>C,Gs:()=>j,OQ:()=>N,TK:()=>F,dF:()=>E,kg:()=>A,lC:()=>q,wV:()=>b});var s=r(29021),a=r.n(s),i=r(33873),n=r.n(i),o=r(28354),u=r(85665),c=r.n(u),p=r(43205),d=r.n(p);let l=(0,o.promisify)(a().mkdir),f=(0,o.promisify)(a().readFile),w=(0,o.promisify)(a().writeFile),y=(0,o.promisify)(a().access),h=n().resolve(process.cwd(),"data"),g=n().join(h,"users.json"),m=n().join(h,"sessions.json");async function x(){try{await y(h,a().constants.F_OK)}catch{await l(h,{recursive:!0})}try{await y(g,a().constants.F_OK)}catch{await w(g,JSON.stringify({version:1,users:[]},null,2),"utf8")}try{await y(m,a().constants.F_OK)}catch{await w(m,JSON.stringify({version:1,sessions:[]},null,2),"utf8")}}async function v(){return await x(),JSON.parse(await f(g,"utf8"))}async function S(e){await w(g,JSON.stringify(e,null,2),"utf8")}async function k(){return await x(),JSON.parse(await f(m,"utf8"))}async function O(e){await w(m,JSON.stringify(e,null,2),"utf8")}async function j(e){return(await v()).users.find(t=>t.email.toLowerCase()===e.toLowerCase())}async function q(e){return(await v()).users.find(t=>t.id===e)}async function A(e){if(await j(e.email))throw Error("Email already exists");let t=await c().hash(e.password,12),r=new Date().toISOString(),s={id:"u_"+Math.random().toString(36).slice(2)+Date.now().toString(36),name:e.name,email:e.email.toLowerCase(),passwordHash:t,phone:e.phone,gender:e.gender,role:e.role||"user",isVerified:!1,createdAt:r,updatedAt:r},a=await v();return a.users.push(s),await S(a),s}async function F(e,t){let r=await v(),s=r.users.findIndex(t=>t.id===e);if(-1===s)throw Error("User not found");let a=r.users[s],i=new Date().toISOString(),n=a.passwordHash;t.password&&(n=await c().hash(t.password,12));let o={...a,...function(e){let t={};return"string"==typeof e.name&&(t.name=e.name),"string"==typeof e.email&&(t.email=e.email.toLowerCase()),"string"==typeof e.phone&&(t.phone=e.phone),"string"==typeof e.gender&&(t.gender=e.gender),"object"==typeof e.address&&(t.address=e.address),"boolean"==typeof e.isVerified&&(t.isVerified=e.isVerified),t}(t),passwordHash:n,updatedAt:i};return r.users[s]=o,await S(r),o}async function C(e,t){return c().compare(t,e.passwordHash)}function N(e){return d().sign({userId:e.id,email:e.email,role:e.role},process.env.JWT_SECRET||"fallback-secret",{expiresIn:"7d"})}async function b(e,t,r){let s=await k();s.sessions.push({token:e,userId:t,issuedAt:Date.now(),expiresAt:r}),await O(s)}async function E(e){let t=await k();t.sessions=t.sessions.filter(t=>t.token!==e),await O(t)}},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580,3205,5665],()=>r(32383));module.exports=s})();