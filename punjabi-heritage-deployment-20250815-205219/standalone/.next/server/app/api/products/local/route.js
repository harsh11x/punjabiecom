(()=>{var e={};e.id=8730,e.ids=[8730],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},52929:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>y,routeModule:()=>f,serverHooks:()=>m,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{GET:()=>w});var a=t(96559),o=t(48088),i=t(37719),n=t(32190),c=t(29021),u=t.n(c),p=t(33873),l=t.n(p);let d=l().resolve(process.cwd(),"data"),g=l().join(d,"products.json");async function w(e){try{let{searchParams:r}=new URL(e.url),t=r.get("category"),s=r.get("subcategory"),a=r.get("search"),o=parseInt(r.get("page")||"1"),i=parseInt(r.get("limit")||"12"),c=r.get("sortBy")||r.get("sort")||"createdAt",p=r.get("sortOrder")||"desc",l=r.get("priceRange"),d=function(){if(!u().existsSync(g))return[];try{let e=u().readFileSync(g,"utf8");return JSON.parse(e)}catch(e){return console.error("Error reading products:",e),[]}}();if(d=d.filter(e=>!1!==e.isActive),t&&"all"!==t&&(d=d.filter(e=>e.category===t)),s&&"all"!==s&&(d=d.filter(e=>e.subcategory===s)),a){let e=a.toLowerCase();d=d.filter(r=>r.name?.toLowerCase().includes(e)||r.punjabiName?.toLowerCase().includes(e)||r.description?.toLowerCase().includes(e)||r.category?.toLowerCase().includes(e)||r.subcategory?.toLowerCase().includes(e))}if(l&&"all"!==l){let[e,r]=l.split("-").map(e=>e.replace("+",""));d=r?d.filter(t=>t.price>=parseInt(e)&&t.price<=parseInt(r)):d.filter(r=>r.price>=parseInt(e))}d.sort((e,r)=>{switch(c){case"newest":return new Date(r.createdAt).getTime()-new Date(e.createdAt).getTime();case"price-low":return e.price-r.price;case"price-high":return r.price-e.price;case"rating":return(r.rating||0)-(e.rating||0);case"popular":return(r.reviews||0)-(e.reviews||0);case"createdAt":if("desc"===p)return new Date(r.createdAt).getTime()-new Date(e.createdAt).getTime();return new Date(e.createdAt).getTime()-new Date(r.createdAt).getTime();default:if("desc"===p)return r[c]>e[c]?1:-1;return e[c]>r[c]?1:-1}});let w=d.length,f=(o-1)*i,x=d.slice(f,f+i);return n.NextResponse.json({success:!0,data:x,pagination:{page:o,limit:i,total:w,pages:Math.ceil(w/i)}})}catch(e){return console.error("Error fetching products:",e),n.NextResponse.json({success:!1,error:"Failed to fetch products"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/products/local/route",pathname:"/api/products/local",filename:"route",bundlePath:"app/api/products/local/route"},resolvedPagePath:"/Users/harsh/Downloads/punjabi-ecom-storeV4/app/api/products/local/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:h,serverHooks:m}=f;function y(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:h})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4447,580],()=>t(52929));module.exports=s})();